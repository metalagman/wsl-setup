- name: Install Claude Code CLI tool via npm
  community.general.npm:
    name: "@anthropic-ai/claude-code"
    global: true
    state: present
  become: false
  register: ai_claude_code_result

- name: Verify Claude Code installation
  ansible.builtin.command: claude --version
  register: ai_claude_code_version
  failed_when: false
  changed_when: false

- name: Display Claude Code version
  ansible.builtin.debug:
    msg: "Claude Code version: {{ ai_claude_code_version.stdout }}"
  when: ai_claude_code_version.rc == 0

- name: Notify if Claude Code verification failed
  ansible.builtin.debug:
    msg: "Could not verify Claude Code installation"
  when: ai_claude_code_version.rc != 0
